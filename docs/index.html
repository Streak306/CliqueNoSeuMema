<!doctype html>
<meta charset="utf-8">
<title>Clique no seu Mema</title>
<style>
  :root{
    --maxw: 1200px;
    --gap: 20px;
    --sidew: 280px;
  }
  *{box-sizing:border-box}
  body{font-family:system-ui;margin:0;background:#fff;color:#111}
  .wrap{max-width:var(--maxw);margin:0 auto;padding:28px}

  /* Topo */
  h1{margin:0 0 10px 0;font-size:2.2rem}
  .stats{display:flex;gap:10px;flex-wrap:wrap}
  .pill{display:inline-block;padding:6px 12px;border:1px solid #ddd;border-radius:999px}
  #pts{font-size:1.6rem;font-variant-numeric:tabular-nums}

  /* Grid principal: esquerda | centro | direita */
  .grid{
    display:grid;
    grid-template-columns: var(--sidew) 1fr var(--sidew);
    gap: var(--gap);
    align-items:start;
    margin-top: 20px;
  }
  .card{
    border:1px solid #e4e4e7;border-radius:14px;padding:14px;
    background:#fafafa;
  }

  /* Palco central com Mema */
  .stage{
    display:grid; place-items:center;
    min-height: min(70vh, 720px);
    border:1px dashed #e5e7eb; border-radius:14px;
    background:#fff;
  }
  .click-img{
    width:clamp(220px, 40vw, 380px);
    height:clamp(220px, 40vw, 380px);
    object-fit:cover;
    border:1px solid #ccc;border-radius:16px;cursor:pointer;
    box-shadow:0 8px 24px rgba(0,0,0,.12);
    transition:transform .06s ease, filter .15s ease;
    user-select:none;
  }
  .click-img:hover{ filter:brightness(1.05); }
  .click-img:active{ transform:translateY(1px) scale(.98); }

  /* Botões */
  .btn{padding:10px 14px;border:1px solid #ccc;border-radius:10px;cursor:pointer;background:#fff;width:100%}
  .btn + .btn{margin-top:12px}
  .btn-danger{border-color:#fecaca;background:#fff;color:#b91c1c}
  .btn-danger:hover{background:#fff0f0}

  /* Indicador de save (canto inferior) */
  .save-toast{
    position:fixed; right:16px; bottom:16px;
    background:#e8f0ff; color:#1d4ed8;
    border:1px solid #bfdbfe; border-radius:999px;
    padding:8px 12px; font-weight:600; font-size:14px;
    box-shadow:0 4px 16px rgba(0,0,0,.08);
    opacity:0; transform:translateY(8px);
    pointer-events:none;
    transition:opacity .6s ease, transform .6s ease;
  }
  .save-toast.show{ opacity:1; transform:translateY(0); }

  /* Responsivo: empilha em telas pequenas */
  @media (max-width: 900px){
    .grid{ grid-template-columns: 1fr; }
    .stage{ min-height: 50vh; }
  }
</style>

<!-- TOPO -->
<header>
  <h1>Clique no seu Mema</h1>
  <div class="stats">
    <span class="pill">Pontos: <b id="pts">0</b></span>
    <span class="pill">Por clique: <b id="pc">1</b></span>
    <span class="pill">Auto/s: <b id="cps">0</b></span>
  </div>
</header>

<!-- GRID -->
<main class="grid">
  <!-- ESQUERDA: reservado -->
  <aside class="card">
    <h3 style="margin:6px 0 10px">Aba esquerda</h3>
    <p style="margin:0;opacity:.75">Espaço reservado pra um modo/aba futura.</p>
  </aside>

  <!-- CENTRO: Mema grande -->
  <section class="stage">
    <img id="click" class="click-img" src="mema_back.png" alt="Clique no seu Mema">
  </section>

  <!-- DIREITA: upgrades -->
  <aside class="card">
    <button class="btn" id="buyAuto">Comprar Autoclick +1/s
      (Custo: <span id="costAuto">10</span>)
    </button>
    <button class="btn" id="buyPower">Aumentar Poder do Clique +1
      (Custo: <span id="costPow">50</span>)
    </button>
    <!-- NOVO: apagar save -->
    <button class="btn btn-danger" id="deleteSave">Apagar save</button>
  </aside>
</main>

<!-- Indicador de save -->
<div id="saveToast" class="save-toast">salvo</div>

<script>
/* --- estado do jogo --- */
let pts=0, clickPow=1, auto=0;
let costAuto=10, costPow=50;

/* --- imagens do Mema --- */
const IMG_BACK  = 'mema_back.png';
const IMG_FRONT = 'mema_front.png';
const FRONT_TIME_MS = 400; // feedback rápido ao clicar
let faceTimer = null;

/* helpers */
const el=(id)=>document.getElementById(id);

function save(showToast=false){
  localStorage.setItem('mcw', JSON.stringify({pts,clickPow,auto,costAuto,costPow}));
  if(showToast) flashSave();
}

function load(){ try{
  const d = JSON.parse(localStorage.getItem('mcw')||'{}');
  pts=d.pts??0; clickPow=d.clickPow??1; auto=d.auto??0;
  costAuto=d.costAuto??10; costPow=d.costPow??50;
} catch(e){} }

function fmt(n){ return Math.round(n); }
function render(){
  el('pts').textContent=fmt(pts);
  el('pc').textContent=clickPow;
  el('cps').textContent=auto;
  el('costAuto').textContent=Math.ceil(costAuto);
  el('costPow').textContent=Math.ceil(costPow);
}

/* vira de frente por um tempinho e volta */
function showFront(){
  const img = el('click');
  img.src = IMG_FRONT;
  if (faceTimer) clearTimeout(faceTimer);
  faceTimer = setTimeout(()=>{ img.src = IMG_BACK; }, FRONT_TIME_MS);
}

/* compras */
function buyAuto(){
  if(pts>=costAuto){
    pts-=costAuto; auto+=1; costAuto*=1.15;
    render(); save(); // salva normal (sem toast)
  }
}
function buyPower(){
  if(pts>=costPow){
    pts-=costPow; clickPow+=1; costPow*=1.25;
    render(); save(); // salva normal (sem toast)
  }
}

/* NOVO: apagar save e resetar */
function resetState(){
  pts=0; clickPow=1; auto=0; costAuto=10; costPow=50;
}
function deleteSave(){
  const ok = confirm('Apagar seu save? Esta ação não pode ser desfeita.');
  if(!ok) return;
  localStorage.removeItem('mcw');
  resetState(); render();
}

/* loop de pontos automáticos */
function loop(){
  let last=performance.now();
  function tick(){
    const now=performance.now(), dt=(now-last)/1000; last=now;
    pts+=auto*dt; render();
    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
}

/* NOVO: auto-save periódico + toast */
let saveTimer = null;
function startAutoSave(){
  // salva a cada 5 segundos e mostra o "salvo"
  if(saveTimer) clearInterval(saveTimer);
  saveTimer = setInterval(()=> save(true), 5000);
}
let toastTimer=null;
function flashSave(){
  const t = el('saveToast');
  t.textContent = 'salvo';
  t.classList.add('show');
  if(toastTimer) clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> t.classList.remove('show'), 1400);
}

/* preload imagens */
(new Image()).src = IMG_BACK;
(new Image()).src = IMG_FRONT;

/* init */
load(); render(); loop(); startAutoSave();

/* clique na imagem */
el('click').onclick=()=>{ pts+=clickPow; render(); save(); showFront(); };
el('buyAuto').onclick=buyAuto;
el('buyPower').onclick=buyPower;
el('deleteSave').onclick=deleteSave;
</script>
